var explorerMvc=function(){function h(a,b){return'<div class="file" id="file-'+b.id+'" num="'+a+'"><img src="'+(explorerData.dataUrl+"preview/"+b.path+b.file)+'" type="sel"/><div class="panel"><img src="'+f+'image-16.png" type="view"/><img src="'+f+'ok-16.png" type="sel"/><img src="'+f+'delete-16.png" type="rm"/></div><div class="status" type="sel"></div></div>'}function j(a){var b=jQuery(a.target).attr("type");if(b){a=jQuery(a.target).parents(".file:first");var c=parseInt(a.attr("num")),c=explorerData.list[c];
"view"==b?jQuery.lightbox(explorerData.dataUrl+"src/"+c.path+c.file):(a.hasClass("type-"+b)?(a.removeClass("type-"+b),delete d[c.id]):(a.addClass("type-"+b),d[c.id]=b),"sel"==b?a.removeClass("type-rm"):a.removeClass("type-sel"))}}function k(){var a={list:{},length:0},b;for(b in d)if("sel"==d[b])for(var c in explorerData.list){var e=explorerData.list[c];e.id==b&&(a.list[b]=explorerData.dataUrl+"src/"+e.path+e.file,a.length++)}explorerMvc.onCallback(a);window.close();return!1}function l(a){for(var b in a.list)jQuery("#file-"+
a.list[b]).remove()}function m(){if(!confirm("\u0423\u0434\u0430\u043b\u0438\u0442\u044c?"))return!1;var a=[],b;for(b in d)"rm"==d[b]&&a.push(b);$.ajax({url:"?action=rm&profile="+explorerData.profile+"&group="+explorerData.group+"&subgroup="+explorerData.subgroup,data:"list="+a.join(","),type:"POST"}).done(l);return!1}function n(a){try{500>a?this.startUpload():0!=a&&alert("\u041d\u0435 \u0431\u043e\u043b\u044c\u0448\u0435 10 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0439 \u0437\u0430 \u0440\u0430\u0437")}catch(b){this.debug(b)}}
function p(){try{0<this.getStats().files_queued?this.startUpload():console.log("all image get")}catch(a){this.debug(a)}}function q(a,b){try{var c=$.parseJSON(b);if(c.error)alert(c.error.msg);else{var d=explorerData.list.push(c.data)-1,e=h(d,c.data);g.append(e)}}catch(f){this.debug(f)}}function r(){if("rm"!=e){for(var a in explorerData.list){var b=explorerData.list[a];jQuery("#file-"+b.id).addClass("type-rm").removeClass("type-sel");d[b.id]="rm"}e="rm"}else d={},jQuery(".file").removeClass("type-rm"),
e=null;return!1}function s(){if("sel"!=e){for(var a in explorerData.list){var b=explorerData.list[a];jQuery("#file-"+b.id).addClass("type-sel").removeClass("type-rm");d[b.id]="sel"}e="sel"}else d={},jQuery(".file").removeClass("type-sel"),e=null;return!1}var g,f="http://theme.codecampus.ru/plugin/icons/img/",d={},e=null;return{init:function(){g=jQuery("#explorerPanel");var a="",b;for(b in explorerData.list)a+=h(b,explorerData.list[b]);g.html(a);new SWFUpload({upload_url:"http://codecampus.ru/livevideo/settings/slide/?action=upload&profile="+
explorerData.profile+"&group="+explorerData.group+"&subgroup="+explorerData.subgroup,flash_url:"http://theme.codecampus.ru/plugin/SWFUpload_v2.2.0.1/swfupload.swf",file_size_limit:"20 MB",button_image_url:"http://theme.codecampus.ru/plugin/SWFUpload_v2.2.0.1//XPButtonUploadText_61x22.png",button_placeholder_id:"uploadBtn",button_width:61,button_height:22,button_window_mode:"opaque",file_post_name:"file",file_types:"*.jpg;*.gif;*.png;*.jpeg",file_types_description:"Image files",file_dialog_complete_handler:n,
upload_complete_handler:p,upload_success_handler:q,debug:!1,debug_handler:function(){}});g.click(j);jQuery("#rmBtn").click(m);jQuery("#rmAllBtn").click(r);jQuery("#selAllBtn").click(s);jQuery("#selectBtn").click(k)},onCallback:function(){},initData:function(a){if(a.list)for(var b in a.list){var c=a.list[b];jQuery("#file-"+c).addClass("type-sel");d[c]="sel"}}}}();